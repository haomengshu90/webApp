function previewImage(f,c,l,h){var e=90;var d=90;var b=document.getElementById(c);if(f.files&&f.files[0]){b.innerHTML="<img id=imghead"+h+" style='height:100%;width:100%;' onclick=$('#"+l+"').click()>";b.style.background="none";b.style.padding="10px";var g=document.getElementById("imghead"+h);g.onload=function(){var m=clacImgZoomParam(e,d,g.offsetWidth,g.offsetHeight);g.width=m.width;g.height=m.height};var i=new FileReader();i.onload=function(m){g.src=m.target.result};i.readAsDataURL(f.files[0])}else{var j='filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=scale,src="';f.select();var a=document.selection.createRange().text;b.innerHTML="<img id=imghead>";var g=document.getElementById("imghead");g.filters.item("DXImageTransform.Microsoft.AlphaImageLoader").src=a;var k=clacImgZoomParam(e,d,g.offsetWidth,g.offsetHeight);status=("rect:"+k.top+","+k.left+","+k.width+","+k.height);b.innerHTML="<div id=divhead style='width:"+k.width+"px;height:"+k.height+"px;margin-top:"+k.top+"px;"+j+a+"\"'></div>"}}function clacImgZoomParam(d,c,b,a){var e={top:0,left:0,width:b,height:a};if(b>d||a>c){rateWidth=b/d;rateHeight=a/c;if(rateWidth>rateHeight){e.width=d;e.height=Math.round(a/rateWidth)}else{e.width=Math.round(b/rateHeight);e.height=c}}e.left=Math.round((d-e.width)/2);e.top=Math.round((c-e.height)/2);return e};